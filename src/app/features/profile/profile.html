<div class="profile-container">
    
    <div class="header-bg">
        </div>

    <div class="profile-content">
        
        <div class="top-section">
            <div class="avatar-wrapper">
                <img [src]="(isEditing ? editForm.avatarUrl : user.avatarUrl) || 'assets/default-avatar.png'" class="avatar">
                <label *ngIf="isEditing" class="edit-avatar-btn" for="avatarUpload">ğŸ“·</label>
                <input id="avatarUpload" type="file" (change)="onFileSelected($event)" hidden *ngIf="isEditing">
            </div>

            <div class="top-actions" *ngIf="!isEditing">
                <button class="btn-white">ğŸ“‡ Contrato</button>
                <button class="btn-white" (click)="toggleEdit()">âœï¸ Editar</button>
            </div>
        </div>

        <div class="view-mode" *ngIf="!isEditing">
            <div class="user-identity">
                <h1>{{ user.name }}</h1>
                <span *ngIf="user.isVerified" class="verified-badge">âœ”ï¸ Verificado</span>
                <p class="email-cpf">{{ user.cpf || 'CPF nÃ£o informado' }}</p> </div>

            <div class="stats-row">
                <div class="stat">
                    <strong>â­ {{ user.rating || '5,0' }}</strong>
                </div>
                <div class="divider"></div>
                <div class="stat">
                    <strong>30</strong>
                    <span>Necessidades</span>
                </div>
                <div class="divider"></div>
                <div class="stat">
                    <strong>15</strong>
                    <span>PrestaÃ§Ãµes</span>
                </div>
            </div>

            <div class="info-block">
                <div class="location-row">
                    <span>ğŸ“ <strong>{{ user.neighborhood || 'Local nÃ£o informado' }}</strong></span>
    
                    <button 
                        class="status-badge" 
                        [class.available]="isAvailable" 
                        [class.unavailable]="!isAvailable"
                        (click)="toggleAvailability()">
                        {{ isAvailable ? 'DisponÃ­vel' : 'IndisponÃ­vel' }}
                    </button>
                </div>
            </div>

            <div class="info-block">
                <h3>Sobre mim</h3>
                <p>{{ user.biography || 'Nenhuma biografia adicionada.' }}</p>
            </div>

            <div class="info-block">
                <h3>Habilidades</h3>
                <div class="skills-list">
                    <span class="skill-pill" *ngFor="let skill of getSkillsArray(user.skills)">
                        ğŸ·ï¸ {{ skill }}
                    </span>
                </div>
            </div>
        </div>

        <div class="edit-mode" *ngIf="isEditing">
            
            <div class="input-group">
                <span class="icon">T</span>
                <input type="text" [(ngModel)]="editForm.name" placeholder="Nome Completo">
            </div>

            <div class="input-group">
                <span class="icon">ğŸ“</span>
                <input type="text" [(ngModel)]="editForm.neighborhood" placeholder="Bairro - CEP">
            </div>

            <div class="input-group textarea-group">
                <label>Sobre mim</label>
                <textarea [(ngModel)]="editForm.biography" rows="4" maxlength="100"></textarea>
                <span class="counter">{{ editForm.biography?.length || 0 }}/100</span>
            </div>

            <div class="input-group">
                <span class="icon">ğŸ·ï¸</span>
                <input type="text" [(ngModel)]="newSkill" (keyup.enter)="addSkill()" placeholder="Adicionar habilidade + Enter">
            </div>
            
            <div class="skills-list">
                <span class="skill-pill edit" *ngFor="let skill of getSkillsArray(editForm.skills)">
                    {{ skill }} 
                    <span (click)="removeSkill(skill)" class="remove-icon">âœ•</span>
                </span>
            </div>

            <div class="actions-footer">
                <button class="btn-cancel" (click)="toggleEdit()">Cancelar ğŸ—‘ï¸</button>
                <button class="btn-save" (click)="save()">Salvar âœˆï¸</button>
            </div>
        </div>

    </div>
</div>